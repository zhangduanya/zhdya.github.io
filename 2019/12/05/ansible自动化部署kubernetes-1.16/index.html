<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  
  <title>ansible自动化部署kubernetes-1.16 | 成年人的世界哪有容易二字！</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
    <meta name="keywords" content="laoqi,laoqi's Blog">
  
  <meta name="description" content="概述：集群包含coreDNS、cni、nginx-ingress、HA、flanneld 百度网盘链接：https://pan.baidu.com/s/1KYbpshhpTu62DnQwF1LUnQ 提取码：vi5e 一、单master部署12345678910111213141516171819202122232425262728293031323334353637383940414243444">
<meta name="keywords" content="Kubernets,K8S">
<meta property="og:type" content="article">
<meta property="og:title" content="ansible自动化部署kubernetes-1.16">
<meta property="og:url" content="http://zhdya.okay686.cn/2019/12/05/ansible自动化部署kubernetes-1.16/index.html">
<meta property="og:site_name" content="成年人的世界哪有容易二字！">
<meta property="og:description" content="概述：集群包含coreDNS、cni、nginx-ingress、HA、flanneld 百度网盘链接：https://pan.baidu.com/s/1KYbpshhpTu62DnQwF1LUnQ 提取码：vi5e 一、单master部署12345678910111213141516171819202122232425262728293031323334353637383940414243444">
<meta property="og:locale" content="default">
<meta property="og:image" content="http://myimage.okay686.cn/okay686cn/20191204/RlnwtcB5dboO.png?imageslim">
<meta property="og:image" content="http://myimage.okay686.cn/okay686cn/20191204/7GzoI4FprwXv.png?imageslim">
<meta property="og:updated_time" content="2019-12-05T09:13:48.858Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ansible自动化部署kubernetes-1.16">
<meta name="twitter:description" content="概述：集群包含coreDNS、cni、nginx-ingress、HA、flanneld 百度网盘链接：https://pan.baidu.com/s/1KYbpshhpTu62DnQwF1LUnQ 提取码：vi5e 一、单master部署12345678910111213141516171819202122232425262728293031323334353637383940414243444">
<meta name="twitter:image" content="http://myimage.okay686.cn/okay686cn/20191204/RlnwtcB5dboO.png?imageslim">
  
  
    <link rel="icon" href="/favicon.ico">
  
  <link href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css">
  <script src="/js/pace.min.js"></script>
  

  
  

</head>
</html>
<body>
  <div id="container">
      <header id="header">
    <div id="banner"></div>
    <div id="header-outer">
        <div id="header-menu" class="header-menu-pos animated">
            <div class="header-menu-container">
                <a href="/" class="left">
                    <span class="site-title">五谷杂粮，百味人生。</span>
                </a>
                <nav id="header-menu-nav" class="right">
                    
                    <a href="/">
                        <i class="fa fa-home"></i>
                        <span>主页</span>
                    </a>
                    
                    <a href="/archives">
                        <i class="fa fa-archive"></i>
                        <span>归档</span>
                    </a>
                    
                    <a href="/about">
                        <i class="fa fa-user"></i>
                        <span>关于</span>
                    </a>
                    
                </nav>
                <a class="mobile-header-menu-button">
                    <i class="fa fa-bars"></i>
                </a>
            </div>
        </div>
        <div id="header-row">
            <div id="logo">
                <a href="/">
                    <img src="/images/logo.png" alt="logo">
                </a>
            </div>
            <div class="header-info">
                <div id="header-title">
                    
                    <h2>
                        五谷杂粮，百味人生。
                    </h2>
                    
                </div>
                <div id="header-description">
                    
                    <h3>
                        别自己给自己作秀，结果不会给你开玩笑！
                    </h3>
                    
                </div>
            </div>
            <nav class="header-nav">
                <div class="social">
                    
                        <a title="Github" target="_blank" href="//github.com/zhangduanya">
                            <i class="fa fa-github fa-2x"></i></a>
                    
                </div>
            </nav>
        </div>
    </div>
</header>
      <div class="outer">
        <section id="main" class="body-wrap"><article id="post-ansible自动化部署kubernetes-1.16" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 class="post-title" itemprop="name">
      ansible自动化部署kubernetes-1.16
    </h1>
    <div class="post-title-bar">
      <ul>
          
              <li>
                  <i class="fa fa-book"></i>
                  
                      <a href="/categories/K8s/">K8s</a>
                  
              </li>
          
        <li>
          <i class="fa fa-calendar"></i>  2019-12-05
        </li>
        <li>
          <i class="fa fa-eye"></i>
          <span id="busuanzi_value_page_pv"></span>
        </li>
      </ul>
    </div>
  

          
      </header>
    
    <div class="article-entry post-content" itemprop="articleBody">
      
            
            <h3 id="概述："><a href="#概述：" class="headerlink" title="概述："></a>概述：</h3><p>集群包含coreDNS、cni、nginx-ingress、HA、flanneld</p>
<p>百度网盘链接：<a href="https://pan.baidu.com/s/1KYbpshhpTu62DnQwF1LUnQ" target="_blank" rel="noopener">https://pan.baidu.com/s/1KYbpshhpTu62DnQwF1LUnQ</a> 提取码：vi5e</p>
<h3 id="一、单master部署"><a href="#一、单master部署" class="headerlink" title="一、单master部署"></a>一、单master部署</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line">[root@k8s-ansible1 ~]# tree ansible-install-k8s-master</span><br><span class="line">ansible-install-k8s-master</span><br><span class="line">├── add-node.yml</span><br><span class="line">├── ansible.cfg</span><br><span class="line">├── group_vars</span><br><span class="line">│   └── all.yml</span><br><span class="line">├── hosts</span><br><span class="line">├── multi-master-deploy.yml</span><br><span class="line">├── multi-master.jpg</span><br><span class="line">├── README.md</span><br><span class="line">├── roles</span><br><span class="line">│   ├── addons</span><br><span class="line">│   │   ├── files</span><br><span class="line">│   │   │   ├── coredns.yaml</span><br><span class="line">│   │   │   ├── ingress-controller.yaml</span><br><span class="line">│   │   │   ├── kube-flannel.yaml</span><br><span class="line">│   │   │   └── kubernetes-dashboard.yaml</span><br><span class="line">│   │   └── tasks</span><br><span class="line">│   │       └── main.yml</span><br><span class="line">│   ├── common</span><br><span class="line">│   │   ├── tasks</span><br><span class="line">│   │   │   └── main.yml</span><br><span class="line">│   │   └── templates</span><br><span class="line">│   │       └── hosts.j2</span><br><span class="line">│   ├── docker</span><br><span class="line">│   │   ├── files</span><br><span class="line">│   │   │   ├── daemon.json</span><br><span class="line">│   │   │   └── docker.service</span><br><span class="line">│   │   └── tasks</span><br><span class="line">│   │       └── main.yml</span><br><span class="line">│   ├── etcd</span><br><span class="line">│   │   ├── files</span><br><span class="line">│   │   │   └── etcd_cert</span><br><span class="line">│   │   │       ├── ca-key.pem</span><br><span class="line">│   │   │       ├── ca.pem</span><br><span class="line">│   │   │       ├── server-key.pem</span><br><span class="line">│   │   │       └── server.pem</span><br><span class="line">│   │   ├── tasks</span><br><span class="line">│   │   │   └── main.yml</span><br><span class="line">│   │   └── templates</span><br><span class="line">│   │       ├── etcd.conf.j2</span><br><span class="line">│   │       ├── etcd.service.j2</span><br><span class="line">│   │       └── etcd.sh.j2</span><br><span class="line">│   ├── ha</span><br><span class="line">│   │   ├── files</span><br><span class="line">│   │   │   └── check_nginx.sh</span><br><span class="line">│   │   ├── tasks</span><br><span class="line">│   │   │   └── main.yml</span><br><span class="line">│   │   └── templates</span><br><span class="line">│   │       ├── keepalived.conf.j2</span><br><span class="line">│   │       └── nginx.conf.j2</span><br><span class="line">│   ├── master</span><br><span class="line">│   │   ├── files</span><br><span class="line">│   │   │   ├── apiserver-to-kubelet-rbac.yaml</span><br><span class="line">│   │   │   ├── etcd_cert</span><br><span class="line">│   │   │   │   ├── ca.pem</span><br><span class="line">│   │   │   │   ├── server-key.pem</span><br><span class="line">│   │   │   │   └── server.pem</span><br><span class="line">│   │   │   ├── k8s_cert</span><br><span class="line">│   │   │   │   ├── admin-key.pem</span><br><span class="line">│   │   │   │   ├── admin.pem</span><br><span class="line">│   │   │   │   ├── ca-key.pem</span><br><span class="line">│   │   │   │   ├── ca.pem</span><br><span class="line">│   │   │   │   ├── kube-proxy-key.pem</span><br><span class="line">│   │   │   │   ├── kube-proxy.pem</span><br><span class="line">│   │   │   │   ├── server-key.pem</span><br><span class="line">│   │   │   │   └── server.pem</span><br><span class="line">│   │   │   ├── kubelet-bootstrap-rbac.yaml</span><br><span class="line">│   │   │   └── token.csv</span><br><span class="line">│   │   ├── tasks</span><br><span class="line">│   │   │   └── main.yml</span><br><span class="line">│   │   └── templates</span><br><span class="line">│   │       ├── kube-apiserver.conf.j2</span><br><span class="line">│   │       ├── kube-apiserver.service.j2</span><br><span class="line">│   │       ├── kube-controller-manager.conf.j2</span><br><span class="line">│   │       ├── kube-controller-manager.service.j2</span><br><span class="line">│   │       ├── kube-scheduler.conf.j2</span><br><span class="line">│   │       └── kube-scheduler.service.j2</span><br><span class="line">│   ├── node</span><br><span class="line">│   │   ├── files</span><br><span class="line">│   │   │   └── k8s_cert</span><br><span class="line">│   │   │       ├── ca.pem</span><br><span class="line">│   │   │       ├── kube-proxy-key.pem</span><br><span class="line">│   │   │       └── kube-proxy.pem</span><br><span class="line">│   │   ├── tasks</span><br><span class="line">│   │   │   └── main.yml</span><br><span class="line">│   │   └── templates</span><br><span class="line">│   │       ├── bootstrap.kubeconfig.j2</span><br><span class="line">│   │       ├── kubelet-config.yml.j2</span><br><span class="line">│   │       ├── kubelet.conf.j2</span><br><span class="line">│   │       ├── kubelet.service.j2</span><br><span class="line">│   │       ├── kube-proxy-config.yml.j2</span><br><span class="line">│   │       ├── kube-proxy.conf.j2</span><br><span class="line">│   │       ├── kube-proxy.kubeconfig.j2</span><br><span class="line">│   │       └── kube-proxy.service.j2</span><br><span class="line">│   └── tls</span><br><span class="line">│       ├── files</span><br><span class="line">│       │   ├── generate_etcd_cert.sh</span><br><span class="line">│       │   └── generate_k8s_cert.sh</span><br><span class="line">│       ├── tasks</span><br><span class="line">│       │   └── main.yml</span><br><span class="line">│       └── templates</span><br><span class="line">│           ├── etcd</span><br><span class="line">│           │   ├── ca-config.json.j2</span><br><span class="line">│           │   ├── ca-csr.json.j2</span><br><span class="line">│           │   └── server-csr.json.j2</span><br><span class="line">│           └── k8s</span><br><span class="line">│               ├── admin-csr.json.j2</span><br><span class="line">│               ├── ca-config.json.j2</span><br><span class="line">│               ├── ca-csr.json.j2</span><br><span class="line">│               ├── kube-proxy-csr.json.j2</span><br><span class="line">│               └── server-csr.json.j2</span><br><span class="line">├── single-master-deploy.yml</span><br><span class="line">└── single-master.jpg</span><br></pre></td></tr></table></figure>
<h4 id="1-1、解压缩binary-pkg-tar-gz"><a href="#1-1、解压缩binary-pkg-tar-gz" class="headerlink" title="1.1、解压缩binary_pkg.tar.gz"></a>1.1、解压缩binary_pkg.tar.gz</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@k8s-ansible1 ~]# ls</span><br><span class="line">anaconda-ks.cfg  ansible-install-k8s-master  ansible-install-k8s-master.zip  binary_pkg.tar.gz</span><br><span class="line">[root@k8s-ansible1 ~]# tar zxvf binary_pkg.tar.gz</span><br></pre></td></tr></table></figure>
<h4 id="1-2、修改所以节点hosts-及ansible内的hosts"><a href="#1-2、修改所以节点hosts-及ansible内的hosts" class="headerlink" title="1.2、修改所以节点hosts 及ansible内的hosts"></a>1.2、修改所以节点hosts 及ansible内的hosts</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">[root@k8s-ansible1 ~]# vim /etc/hosts</span><br><span class="line"></span><br><span class="line">127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4</span><br><span class="line">::1         localhost localhost.localdomain localhost6 localhost6.localdomain6</span><br><span class="line">192.168.171.11 k8s-ansible1     ##ansible机器</span><br><span class="line">192.168.171.12 k8s-ansible2     ##master</span><br><span class="line">192.168.171.13 k8s-ansible3     ##node1</span><br><span class="line">192.168.171.14 k8s-ansible4     ##node2</span><br><span class="line"></span><br><span class="line">[root@k8s-ansible1 ~]# cd ansible-install-k8s-master</span><br><span class="line"></span><br><span class="line">[root@k8s-ansible1 ansible-install-k8s-master]# cat hosts</span><br><span class="line">[master]</span><br><span class="line"># 如果部署单Master，只保留一个Master节点</span><br><span class="line">192.168.171.12 node_name=k8s-ansible2</span><br><span class="line">#192.168.171.111 node_name=k8s-master2</span><br><span class="line"></span><br><span class="line">[node]</span><br><span class="line">192.168.171.13 node_name=k8s-ansible3</span><br><span class="line">192.168.171.14 node_name=k8s-ansible4</span><br><span class="line"></span><br><span class="line">[etcd]</span><br><span class="line">192.168.171.12 etcd_name=k8s-ansible2</span><br><span class="line">192.168.171.13 etcd_name=k8s-ansible3</span><br><span class="line">192.168.171.14 etcd_name=k8s-ansible4</span><br><span class="line"></span><br><span class="line">[lb]</span><br><span class="line"># 如果部署单Master，该项忽略</span><br><span class="line">192.168.31.63 lb_name=lb-master</span><br><span class="line">192.168.31.71 lb_name=lb-backup</span><br><span class="line"></span><br><span class="line">[k8s:children]</span><br><span class="line">master</span><br><span class="line">node</span><br><span class="line"></span><br><span class="line">[newnode]</span><br><span class="line">#192.168.31.91 node_name=k8s-node3</span><br></pre></td></tr></table></figure>
<h4 id="1-3、更改全局环境配置"><a href="#1-3、更改全局环境配置" class="headerlink" title="1.3、更改全局环境配置"></a>1.3、更改全局环境配置</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">[root@k8s-ansible1 ansible-install-k8s-master]# cat group_vars/all.yml</span><br><span class="line"># 安装目录</span><br><span class="line">software_dir: &apos;/root/binary_pkg&apos;</span><br><span class="line">k8s_work_dir: &apos;/opt/kubernetes&apos;</span><br><span class="line">etcd_work_dir: &apos;/opt/etcd&apos;</span><br><span class="line">tmp_dir: &apos;/tmp/k8s&apos;</span><br><span class="line"></span><br><span class="line"># 集群网络</span><br><span class="line">service_cidr: &apos;10.0.0.0/24&apos;</span><br><span class="line">cluster_dns: &apos;10.0.0.2&apos;   # 与roles/addons/files/coredns.yaml中IP一致</span><br><span class="line">pod_cidr: &apos;10.244.0.0/16&apos; # 与roles/addons/files/kube-flannel.yaml中网段一致</span><br><span class="line">service_nodeport_range: &apos;30000-32767&apos;</span><br><span class="line">cluster_domain: &apos;cluster.local&apos;</span><br><span class="line"></span><br><span class="line"># 高可用，如果部署单Master，该项忽略</span><br><span class="line">vip: &apos;192.168.31.88&apos;</span><br><span class="line">nic: &apos;ens33&apos;</span><br><span class="line"></span><br><span class="line"># 自签证书可信任IP列表，为方便扩展，可添加多个预留IP</span><br><span class="line">cert_hosts:</span><br><span class="line">  # 包含所有LB、VIP、Master（多多益善，可以多余出来几个后期扩展用） IP和service_cidr的第一个IP</span><br><span class="line">  k8s:</span><br><span class="line">    - 10.0.0.1</span><br><span class="line">    - 192.168.171.11</span><br><span class="line">    - 192.168.171.12</span><br><span class="line">    - 192.168.171.13</span><br><span class="line">    - 192.168.171.14</span><br><span class="line">    - 192.168.171.15</span><br><span class="line">    - 192.168.171.16</span><br><span class="line">    - 192.168.171.17</span><br><span class="line">    - 192.168.171.18</span><br><span class="line">    - 192.168.171.19</span><br><span class="line">    - 192.168.171.111</span><br><span class="line">  # 包含所有etcd节点IP</span><br><span class="line">  etcd:</span><br><span class="line">    - 192.168.171.12</span><br><span class="line">    - 192.168.171.13</span><br><span class="line">    - 192.168.171.14</span><br></pre></td></tr></table></figure>
<h3 id="二、准备部署"><a href="#二、准备部署" class="headerlink" title="二、准备部署"></a>二、准备部署</h3><h4 id="2-1、单Master版："><a href="#2-1、单Master版：" class="headerlink" title="2.1、单Master版："></a>2.1、单Master版：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible-playbook -i hosts single-master-deploy.yml -uroot -k</span><br></pre></td></tr></table></figure>
<h4 id="2-2、历史记录"><a href="#2-2、历史记录" class="headerlink" title="2.2、历史记录"></a>2.2、历史记录</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br></pre></td><td class="code"><pre><span class="line">[root@k8s-ansible1 ansible-install-k8s-master]# ansible-playbook -i hosts single-master-deploy.yml -uroot -k</span><br><span class="line">SSH password:</span><br><span class="line"></span><br><span class="line">PLAY [0.系统初始化] ********************************************************************************************************************************************************</span><br><span class="line"></span><br><span class="line">TASK [common : 关闭firewalld] *******************************************************************************************************************************************</span><br><span class="line">ok: [192.168.171.14]</span><br><span class="line">ok: [192.168.171.12]</span><br><span class="line">ok: [192.168.171.13]</span><br><span class="line"></span><br><span class="line">TASK [common : 关闭selinux] *********************************************************************************************************************************************</span><br><span class="line">ok: [192.168.171.14]</span><br><span class="line">ok: [192.168.171.13]</span><br><span class="line">ok: [192.168.171.12]</span><br><span class="line"></span><br><span class="line">TASK [common : 关闭swap] ************************************************************************************************************************************************</span><br><span class="line">changed: [192.168.171.12]</span><br><span class="line">changed: [192.168.171.13]</span><br><span class="line">changed: [192.168.171.14]</span><br><span class="line"></span><br><span class="line">TASK [common : 即时生效] **************************************************************************************************************************************************</span><br><span class="line">changed: [192.168.171.13]</span><br><span class="line">changed: [192.168.171.12]</span><br><span class="line">changed: [192.168.171.14]</span><br><span class="line"></span><br><span class="line">TASK [common : 拷贝时区] **************************************************************************************************************************************************</span><br><span class="line">ok: [192.168.171.14]</span><br><span class="line">ok: [192.168.171.12]</span><br><span class="line">ok: [192.168.171.13]</span><br><span class="line"></span><br><span class="line">TASK [common : 添加hosts] ***********************************************************************************************************************************************</span><br><span class="line">ok: [192.168.171.12]</span><br><span class="line">ok: [192.168.171.14]</span><br><span class="line">ok: [192.168.171.13]</span><br><span class="line"></span><br><span class="line">PLAY [1.自签证书] *********************************************************************************************************************************************************</span><br><span class="line"></span><br><span class="line">TASK [tls : 获取Ansible工作目录] ********************************************************************************************************************************************</span><br><span class="line">changed: [localhost]</span><br><span class="line"></span><br><span class="line">TASK [tls : 创建工作目录] ***************************************************************************************************************************************************</span><br><span class="line">ok: [localhost] =&gt; (item=etcd)</span><br><span class="line">ok: [localhost] =&gt; (item=k8s)</span><br><span class="line"></span><br><span class="line">TASK [tls : 准备cfssl工具] ************************************************************************************************************************************************</span><br><span class="line">ok: [localhost]</span><br><span class="line"></span><br><span class="line">TASK [tls : 准备etcd证书请求文件] *********************************************************************************************************************************************</span><br><span class="line">ok: [localhost] =&gt; (item=ca-config.json.j2)</span><br><span class="line">ok: [localhost] =&gt; (item=ca-csr.json.j2)</span><br><span class="line">ok: [localhost] =&gt; (item=server-csr.json.j2)</span><br><span class="line"></span><br><span class="line">TASK [tls : 准备生成etcd证书脚本] *********************************************************************************************************************************************</span><br><span class="line">ok: [localhost]</span><br><span class="line"></span><br><span class="line">TASK [tls : 生成etcd证书] *************************************************************************************************************************************************</span><br><span class="line">changed: [localhost]</span><br><span class="line"></span><br><span class="line">TASK [tls : 准备k8s证书请求文件] **********************************************************************************************************************************************</span><br><span class="line">ok: [localhost] =&gt; (item=ca-config.json.j2)</span><br><span class="line">ok: [localhost] =&gt; (item=ca-csr.json.j2)</span><br><span class="line">ok: [localhost] =&gt; (item=server-csr.json.j2)</span><br><span class="line">ok: [localhost] =&gt; (item=admin-csr.json.j2)</span><br><span class="line">ok: [localhost] =&gt; (item=kube-proxy-csr.json.j2)</span><br><span class="line"></span><br><span class="line">TASK [tls : 准备生成k8s证书脚本] **********************************************************************************************************************************************</span><br><span class="line">ok: [localhost]</span><br><span class="line"></span><br><span class="line">TASK [tls : 生成k8s证书] **************************************************************************************************************************************************</span><br><span class="line">changed: [localhost]</span><br><span class="line"></span><br><span class="line">PLAY [2.部署Docker] *****************************************************************************************************************************************************</span><br><span class="line"></span><br><span class="line">TASK [docker : 创建临时目录] ************************************************************************************************************************************************</span><br><span class="line">ok: [192.168.171.12]</span><br><span class="line">ok: [192.168.171.13]</span><br><span class="line">ok: [192.168.171.14]</span><br><span class="line"></span><br><span class="line">TASK [docker : 分发并解压docker二进制包] ***************************************************************************************************************************************</span><br><span class="line">ok: [192.168.171.14] =&gt; (item=/root/binary_pkg/docker-18.09.6.tgz)</span><br><span class="line">ok: [192.168.171.12] =&gt; (item=/root/binary_pkg/docker-18.09.6.tgz)</span><br><span class="line">ok: [192.168.171.13] =&gt; (item=/root/binary_pkg/docker-18.09.6.tgz)</span><br><span class="line"></span><br><span class="line">TASK [docker : 移动docker二进制文件] *****************************************************************************************************************************************</span><br><span class="line">changed: [192.168.171.13]</span><br><span class="line">changed: [192.168.171.12]</span><br><span class="line">changed: [192.168.171.14]</span><br><span class="line"></span><br><span class="line">TASK [docker : 分发service文件] *******************************************************************************************************************************************</span><br><span class="line">ok: [192.168.171.12]</span><br><span class="line">ok: [192.168.171.13]</span><br><span class="line">ok: [192.168.171.14]</span><br><span class="line"></span><br><span class="line">TASK [docker : 创建目录] **************************************************************************************************************************************************</span><br><span class="line">ok: [192.168.171.12]</span><br><span class="line">ok: [192.168.171.13]</span><br><span class="line">ok: [192.168.171.14]</span><br><span class="line"></span><br><span class="line">TASK [docker : 配置docker] **********************************************************************************************************************************************</span><br><span class="line">ok: [192.168.171.12]</span><br><span class="line">ok: [192.168.171.13]</span><br><span class="line">ok: [192.168.171.14]</span><br><span class="line"></span><br><span class="line">TASK [docker : 启动docker] **********************************************************************************************************************************************</span><br><span class="line">changed: [192.168.171.12]</span><br><span class="line">changed: [192.168.171.13]</span><br><span class="line">changed: [192.168.171.14]</span><br><span class="line"></span><br><span class="line">TASK [docker : 查看状态] **************************************************************************************************************************************************</span><br><span class="line">changed: [192.168.171.12]</span><br><span class="line">changed: [192.168.171.13]</span><br><span class="line">changed: [192.168.171.14]</span><br><span class="line"></span><br><span class="line">TASK [docker : debug] *************************************************************************************************************************************************</span><br><span class="line">ok: [192.168.171.13] =&gt; &#123;</span><br><span class="line">    &quot;docker.stdout_lines&quot;: [</span><br><span class="line">        &quot;Containers: 0&quot;,</span><br><span class="line">        &quot; Running: 0&quot;,</span><br><span class="line">        &quot; Paused: 0&quot;,</span><br><span class="line">        &quot; Stopped: 0&quot;,</span><br><span class="line">        &quot;Images: 0&quot;,</span><br><span class="line">        &quot;Server Version: 18.09.6&quot;,</span><br><span class="line">        &quot;Storage Driver: overlay2&quot;,</span><br><span class="line">        &quot; Backing Filesystem: xfs&quot;,</span><br><span class="line">        &quot; Supports d_type: true&quot;,</span><br><span class="line">        &quot; Native Overlay Diff: true&quot;,</span><br><span class="line">        &quot;Logging Driver: json-file&quot;,</span><br><span class="line">        &quot;Cgroup Driver: cgroupfs&quot;,</span><br><span class="line">        &quot;Plugins:&quot;,</span><br><span class="line">        &quot; Volume: local&quot;,</span><br><span class="line">        &quot; Network: bridge host macvlan null overlay&quot;,</span><br><span class="line">        &quot; Log: awslogs fluentd gcplogs gelf journald json-file local logentries splunk syslog&quot;,</span><br><span class="line">        &quot;Swarm: inactive&quot;,</span><br><span class="line">        &quot;Runtimes: runc&quot;,</span><br><span class="line">        &quot;Default Runtime: runc&quot;,</span><br><span class="line">        &quot;Init Binary: docker-init&quot;,</span><br><span class="line">        &quot;containerd version: bb71b10fd8f58240ca47fbb579b9d1028eea7c84&quot;,</span><br><span class="line">        &quot;runc version: 2b18fe1d885ee5083ef9f0838fee39b62d653e30&quot;,</span><br><span class="line">        &quot;init version: fec3683&quot;,</span><br><span class="line">        &quot;Security Options:&quot;,</span><br><span class="line">        &quot; seccomp&quot;,</span><br><span class="line">        &quot;  Profile: default&quot;,</span><br><span class="line">        &quot;Kernel Version: 3.10.0-957.el7.x86_64&quot;,</span><br><span class="line">        &quot;Operating System: CentOS Linux 7 (Core)&quot;,</span><br><span class="line">        &quot;OSType: linux&quot;,</span><br><span class="line">        &quot;Architecture: x86_64&quot;,</span><br><span class="line">        &quot;CPUs: 2&quot;,</span><br><span class="line">        &quot;Total Memory: 1.777GiB&quot;,</span><br><span class="line">        &quot;Name: k8s-ansible3&quot;,</span><br><span class="line">        &quot;ID: O3LF:KDZ3:CXD6:MU6T:3DKL:PS42:6ATX:R4QE:GMI7:QHNO:CVQO:7ZW6&quot;,</span><br><span class="line">        &quot;Docker Root Dir: /var/lib/docker&quot;,</span><br><span class="line">        &quot;Debug Mode (client): false&quot;,</span><br><span class="line">        &quot;Debug Mode (server): false&quot;,</span><br><span class="line">        &quot;Registry: https://index.docker.io/v1/&quot;,</span><br><span class="line">        &quot;Labels:&quot;,</span><br><span class="line">        &quot;Experimental: false&quot;,</span><br><span class="line">        &quot;Insecure Registries:&quot;,</span><br><span class="line">        &quot; 192.168.31.70&quot;,</span><br><span class="line">        &quot; 127.0.0.0/8&quot;,</span><br><span class="line">        &quot;Registry Mirrors:&quot;,</span><br><span class="line">        &quot; http://bc437cce.m.daocloud.io/&quot;,</span><br><span class="line">        &quot;Live Restore Enabled: false&quot;,</span><br><span class="line">        &quot;Product License: Community Engine&quot;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br><span class="line">ok: [192.168.171.12] =&gt; &#123;</span><br><span class="line">    &quot;docker.stdout_lines&quot;: [</span><br><span class="line">        &quot;Containers: 0&quot;,</span><br><span class="line">        &quot; Running: 0&quot;,</span><br><span class="line">        &quot; Paused: 0&quot;,</span><br><span class="line">        &quot; Stopped: 0&quot;,</span><br><span class="line">        &quot;Images: 0&quot;,</span><br><span class="line">        &quot;Server Version: 18.09.6&quot;,</span><br><span class="line">        &quot;Storage Driver: overlay2&quot;,</span><br><span class="line">        &quot; Backing Filesystem: xfs&quot;,</span><br><span class="line">        &quot; Supports d_type: true&quot;,</span><br><span class="line">        &quot; Native Overlay Diff: true&quot;,</span><br><span class="line">        &quot;Logging Driver: json-file&quot;,</span><br><span class="line">        &quot;Cgroup Driver: cgroupfs&quot;,</span><br><span class="line">        &quot;Plugins:&quot;,</span><br><span class="line">        &quot; Volume: local&quot;,</span><br><span class="line">        &quot; Network: bridge host macvlan null overlay&quot;,</span><br><span class="line">        &quot; Log: awslogs fluentd gcplogs gelf journald json-file local logentries splunk syslog&quot;,</span><br><span class="line">        &quot;Swarm: inactive&quot;,</span><br><span class="line">        &quot;Runtimes: runc&quot;,</span><br><span class="line">        &quot;Default Runtime: runc&quot;,</span><br><span class="line">        &quot;Init Binary: docker-init&quot;,</span><br><span class="line">        &quot;containerd version: bb71b10fd8f58240ca47fbb579b9d1028eea7c84&quot;,</span><br><span class="line">        &quot;runc version: 2b18fe1d885ee5083ef9f0838fee39b62d653e30&quot;,</span><br><span class="line">        &quot;init version: fec3683&quot;,</span><br><span class="line">        &quot;Security Options:&quot;,</span><br><span class="line">        &quot; seccomp&quot;,</span><br><span class="line">        &quot;  Profile: default&quot;,</span><br><span class="line">        &quot;Kernel Version: 3.10.0-957.el7.x86_64&quot;,</span><br><span class="line">        &quot;Operating System: CentOS Linux 7 (Core)&quot;,</span><br><span class="line">        &quot;OSType: linux&quot;,</span><br><span class="line">        &quot;Architecture: x86_64&quot;,</span><br><span class="line">        &quot;CPUs: 2&quot;,</span><br><span class="line">        &quot;Total Memory: 1.777GiB&quot;,</span><br><span class="line">        &quot;Name: k8s-ansible2&quot;,</span><br><span class="line">        &quot;ID: DFQT:2YYV:YWY5:IXSS:U6VS:BW7R:6MPH:WCLC:QKOW:Y63I:5TV6:C3HT&quot;,</span><br><span class="line">        &quot;Docker Root Dir: /var/lib/docker&quot;,</span><br><span class="line">        &quot;Debug Mode (client): false&quot;,</span><br><span class="line">        &quot;Debug Mode (server): false&quot;,</span><br><span class="line">        &quot;Registry: https://index.docker.io/v1/&quot;,</span><br><span class="line">        &quot;Labels:&quot;,</span><br><span class="line">        &quot;Experimental: false&quot;,</span><br><span class="line">        &quot;Insecure Registries:&quot;,</span><br><span class="line">        &quot; 192.168.31.70&quot;,</span><br><span class="line">        &quot; 127.0.0.0/8&quot;,</span><br><span class="line">        &quot;Registry Mirrors:&quot;,</span><br><span class="line">        &quot; http://bc437cce.m.daocloud.io/&quot;,</span><br><span class="line">        &quot;Live Restore Enabled: false&quot;,</span><br><span class="line">        &quot;Product License: Community Engine&quot;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br><span class="line">ok: [192.168.171.14] =&gt; &#123;</span><br><span class="line">    &quot;docker.stdout_lines&quot;: [</span><br><span class="line">        &quot;Containers: 0&quot;,</span><br><span class="line">        &quot; Running: 0&quot;,</span><br><span class="line">        &quot; Paused: 0&quot;,</span><br><span class="line">        &quot; Stopped: 0&quot;,</span><br><span class="line">        &quot;Images: 0&quot;,</span><br><span class="line">        &quot;Server Version: 18.09.6&quot;,</span><br><span class="line">        &quot;Storage Driver: overlay2&quot;,</span><br><span class="line">        &quot; Backing Filesystem: xfs&quot;,</span><br><span class="line">        &quot; Supports d_type: true&quot;,</span><br><span class="line">        &quot; Native Overlay Diff: true&quot;,</span><br><span class="line">        &quot;Logging Driver: json-file&quot;,</span><br><span class="line">        &quot;Cgroup Driver: cgroupfs&quot;,</span><br><span class="line">        &quot;Plugins:&quot;,</span><br><span class="line">        &quot; Volume: local&quot;,</span><br><span class="line">        &quot; Network: bridge host macvlan null overlay&quot;,</span><br><span class="line">        &quot; Log: awslogs fluentd gcplogs gelf journald json-file local logentries splunk syslog&quot;,</span><br><span class="line">        &quot;Swarm: inactive&quot;,</span><br><span class="line">        &quot;Runtimes: runc&quot;,</span><br><span class="line">        &quot;Default Runtime: runc&quot;,</span><br><span class="line">        &quot;Init Binary: docker-init&quot;,</span><br><span class="line">        &quot;containerd version: bb71b10fd8f58240ca47fbb579b9d1028eea7c84&quot;,</span><br><span class="line">        &quot;runc version: 2b18fe1d885ee5083ef9f0838fee39b62d653e30&quot;,</span><br><span class="line">        &quot;init version: fec3683&quot;,</span><br><span class="line">        &quot;Security Options:&quot;,</span><br><span class="line">        &quot; seccomp&quot;,</span><br><span class="line">        &quot;  Profile: default&quot;,</span><br><span class="line">        &quot;Kernel Version: 3.10.0-957.el7.x86_64&quot;,</span><br><span class="line">        &quot;Operating System: CentOS Linux 7 (Core)&quot;,</span><br><span class="line">        &quot;OSType: linux&quot;,</span><br><span class="line">        &quot;Architecture: x86_64&quot;,</span><br><span class="line">        &quot;CPUs: 2&quot;,</span><br><span class="line">        &quot;Total Memory: 1.777GiB&quot;,</span><br><span class="line">        &quot;Name: k8s-ansible4&quot;,</span><br><span class="line">        &quot;ID: M3EP:OAKQ:6AMI:RDC6:QX2H:U34M:5GTT:Q2E7:AFP7:C4M3:FUO2:UHS3&quot;,</span><br><span class="line">        &quot;Docker Root Dir: /var/lib/docker&quot;,</span><br><span class="line">        &quot;Debug Mode (client): false&quot;,</span><br><span class="line">        &quot;Debug Mode (server): false&quot;,</span><br><span class="line">        &quot;Registry: https://index.docker.io/v1/&quot;,</span><br><span class="line">        &quot;Labels:&quot;,</span><br><span class="line">        &quot;Experimental: false&quot;,</span><br><span class="line">        &quot;Insecure Registries:&quot;,</span><br><span class="line">        &quot; 192.168.31.70&quot;,</span><br><span class="line">        &quot; 127.0.0.0/8&quot;,</span><br><span class="line">        &quot;Registry Mirrors:&quot;,</span><br><span class="line">        &quot; http://bc437cce.m.daocloud.io/&quot;,</span><br><span class="line">        &quot;Live Restore Enabled: false&quot;,</span><br><span class="line">        &quot;Product License: Community Engine&quot;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">PLAY [3.部署ETCD集群] *****************************************************************************************************************************************************</span><br><span class="line"></span><br><span class="line">TASK [etcd : 创建工作目录] **************************************************************************************************************************************************</span><br><span class="line">ok: [192.168.171.12] =&gt; (item=bin)</span><br><span class="line">ok: [192.168.171.13] =&gt; (item=bin)</span><br><span class="line">ok: [192.168.171.14] =&gt; (item=bin)</span><br><span class="line">ok: [192.168.171.12] =&gt; (item=cfg)</span><br><span class="line">ok: [192.168.171.13] =&gt; (item=cfg)</span><br><span class="line">ok: [192.168.171.14] =&gt; (item=cfg)</span><br><span class="line">ok: [192.168.171.12] =&gt; (item=ssl)</span><br><span class="line">ok: [192.168.171.13] =&gt; (item=ssl)</span><br><span class="line">ok: [192.168.171.14] =&gt; (item=ssl)</span><br><span class="line"></span><br><span class="line">TASK [etcd : 创建临时目录] **************************************************************************************************************************************************</span><br><span class="line">ok: [192.168.171.12]</span><br><span class="line">ok: [192.168.171.13]</span><br><span class="line">ok: [192.168.171.14]</span><br><span class="line"></span><br><span class="line">TASK [etcd : 分发并解压etcd二进制包] *******************************************************************************************************************************************</span><br><span class="line">ok: [192.168.171.12] =&gt; (item=/root/binary_pkg/etcd-v3.3.13-linux-amd64.tar.gz)</span><br><span class="line">ok: [192.168.171.14] =&gt; (item=/root/binary_pkg/etcd-v3.3.13-linux-amd64.tar.gz)</span><br><span class="line">ok: [192.168.171.13] =&gt; (item=/root/binary_pkg/etcd-v3.3.13-linux-amd64.tar.gz)</span><br><span class="line"></span><br><span class="line">TASK [etcd : 移动etcd二进制文件] *********************************************************************************************************************************************</span><br><span class="line">changed: [192.168.171.12]</span><br><span class="line">changed: [192.168.171.14]</span><br><span class="line">changed: [192.168.171.13]</span><br><span class="line"></span><br><span class="line">TASK [etcd : 分发证书] ****************************************************************************************************************************************************</span><br><span class="line">changed: [192.168.171.14] =&gt; (item=ca.pem)</span><br><span class="line">changed: [192.168.171.12] =&gt; (item=ca.pem)</span><br><span class="line">changed: [192.168.171.13] =&gt; (item=ca.pem)</span><br><span class="line">changed: [192.168.171.12] =&gt; (item=server.pem)</span><br><span class="line">changed: [192.168.171.13] =&gt; (item=server.pem)</span><br><span class="line">changed: [192.168.171.14] =&gt; (item=server.pem)</span><br><span class="line">changed: [192.168.171.14] =&gt; (item=server-key.pem)</span><br><span class="line">changed: [192.168.171.13] =&gt; (item=server-key.pem)</span><br><span class="line">changed: [192.168.171.12] =&gt; (item=server-key.pem)</span><br><span class="line"></span><br><span class="line">TASK [etcd : 分发etcd配置文件] **********************************************************************************************************************************************</span><br><span class="line">changed: [192.168.171.12]</span><br><span class="line">changed: [192.168.171.13]</span><br><span class="line">changed: [192.168.171.14]</span><br><span class="line"></span><br><span class="line">TASK [etcd : 分发service文件] *********************************************************************************************************************************************</span><br><span class="line">changed: [192.168.171.12]</span><br><span class="line">changed: [192.168.171.13]</span><br><span class="line">changed: [192.168.171.14]</span><br><span class="line"></span><br><span class="line">TASK [etcd : 启动etcd] **************************************************************************************************************************************************</span><br><span class="line">changed: [192.168.171.14]</span><br><span class="line">changed: [192.168.171.12]</span><br><span class="line">changed: [192.168.171.13]</span><br><span class="line"></span><br><span class="line">TASK [etcd : 分发etcd脚本] ************************************************************************************************************************************************</span><br><span class="line">changed: [192.168.171.12]</span><br><span class="line">changed: [192.168.171.14]</span><br><span class="line">changed: [192.168.171.13]</span><br><span class="line"></span><br><span class="line">TASK [etcd : 获取etcd集群状态] **********************************************************************************************************************************************</span><br><span class="line">changed: [192.168.171.12]</span><br><span class="line">changed: [192.168.171.13]</span><br><span class="line">changed: [192.168.171.14]</span><br><span class="line"></span><br><span class="line">TASK [etcd : debug] ***************************************************************************************************************************************************</span><br><span class="line">ok: [192.168.171.13] =&gt; &#123;</span><br><span class="line">    &quot;status.stdout_lines&quot;: [</span><br><span class="line">        &quot;member 5da6acb8be0f9647 is healthy: got healthy result from https://192.168.171.14:2379&quot;,</span><br><span class="line">        &quot;member a747b20fc3712bbc is healthy: got healthy result from https://192.168.171.12:2379&quot;,</span><br><span class="line">        &quot;member f351513a2b4642ac is healthy: got healthy result from https://192.168.171.13:2379&quot;,</span><br><span class="line">        &quot;cluster is healthy&quot;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br><span class="line">ok: [192.168.171.12] =&gt; &#123;</span><br><span class="line">    &quot;status.stdout_lines&quot;: [</span><br><span class="line">        &quot;member 5da6acb8be0f9647 is healthy: got healthy result from https://192.168.171.14:2379&quot;,</span><br><span class="line">        &quot;member a747b20fc3712bbc is healthy: got healthy result from https://192.168.171.12:2379&quot;,</span><br><span class="line">        &quot;member f351513a2b4642ac is healthy: got healthy result from https://192.168.171.13:2379&quot;,</span><br><span class="line">        &quot;cluster is healthy&quot;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br><span class="line">ok: [192.168.171.14] =&gt; &#123;</span><br><span class="line">    &quot;status.stdout_lines&quot;: [</span><br><span class="line">        &quot;member 5da6acb8be0f9647 is healthy: got healthy result from https://192.168.171.14:2379&quot;,</span><br><span class="line">        &quot;member a747b20fc3712bbc is healthy: got healthy result from https://192.168.171.12:2379&quot;,</span><br><span class="line">        &quot;member f351513a2b4642ac is healthy: got healthy result from https://192.168.171.13:2379&quot;,</span><br><span class="line">        &quot;cluster is healthy&quot;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">PLAY [4.部署K8S Master] *************************************************************************************************************************************************</span><br><span class="line"></span><br><span class="line">TASK [master : 创建工作目录] ************************************************************************************************************************************************</span><br><span class="line">changed: [192.168.171.12] =&gt; (item=bin)</span><br><span class="line">changed: [192.168.171.12] =&gt; (item=cfg)</span><br><span class="line">changed: [192.168.171.12] =&gt; (item=ssl)</span><br><span class="line">changed: [192.168.171.12] =&gt; (item=logs)</span><br><span class="line"></span><br><span class="line">TASK [master : 创建临时目录] ************************************************************************************************************************************************</span><br><span class="line">ok: [192.168.171.12]</span><br><span class="line"></span><br><span class="line">TASK [master : 分发并解压k8s二进制包] ******************************************************************************************************************************************</span><br><span class="line">changed: [192.168.171.12] =&gt; (item=/root/binary_pkg/kubernetes-server-linux-amd64-1.16.tar.gz)</span><br><span class="line"></span><br><span class="line">TASK [master : 移动k8s master二进制文件] *************************************************************************************************************************************</span><br><span class="line">changed: [192.168.171.12]</span><br><span class="line"></span><br><span class="line">TASK [master : 分发k8s证书] ***********************************************************************************************************************************************</span><br><span class="line">changed: [192.168.171.12] =&gt; (item=ca.pem)</span><br><span class="line">changed: [192.168.171.12] =&gt; (item=ca-key.pem)</span><br><span class="line">changed: [192.168.171.12] =&gt; (item=server.pem)</span><br><span class="line">changed: [192.168.171.12] =&gt; (item=server-key.pem)</span><br><span class="line"></span><br><span class="line">TASK [master : 分发etcd证书] **********************************************************************************************************************************************</span><br><span class="line">changed: [192.168.171.12] =&gt; (item=ca.pem)</span><br><span class="line">changed: [192.168.171.12] =&gt; (item=server.pem)</span><br><span class="line">changed: [192.168.171.12] =&gt; (item=server-key.pem)</span><br><span class="line"></span><br><span class="line">TASK [master : 分发token文件] *********************************************************************************************************************************************</span><br><span class="line">changed: [192.168.171.12]</span><br><span class="line"></span><br><span class="line">TASK [master : 分发k8s配置文件] *********************************************************************************************************************************************</span><br><span class="line">changed: [192.168.171.12] =&gt; (item=kube-apiserver.conf.j2)</span><br><span class="line">changed: [192.168.171.12] =&gt; (item=kube-controller-manager.conf.j2)</span><br><span class="line">changed: [192.168.171.12] =&gt; (item=kube-scheduler.conf.j2)</span><br><span class="line"></span><br><span class="line">TASK [master : 分发service文件] *******************************************************************************************************************************************</span><br><span class="line">changed: [192.168.171.12] =&gt; (item=kube-apiserver.service.j2)</span><br><span class="line">changed: [192.168.171.12] =&gt; (item=kube-controller-manager.service.j2)</span><br><span class="line">changed: [192.168.171.12] =&gt; (item=kube-scheduler.service.j2)</span><br><span class="line"></span><br><span class="line">TASK [master : 启动k8s master组件] ****************************************************************************************************************************************</span><br><span class="line">changed: [192.168.171.12] =&gt; (item=kube-apiserver)</span><br><span class="line">changed: [192.168.171.12] =&gt; (item=kube-controller-manager)</span><br><span class="line">changed: [192.168.171.12] =&gt; (item=kube-scheduler)</span><br><span class="line"></span><br><span class="line">TASK [master : 查看集群状态] ************************************************************************************************************************************************</span><br><span class="line">changed: [192.168.171.12]</span><br><span class="line"></span><br><span class="line">TASK [master : debug] *************************************************************************************************************************************************</span><br><span class="line">ok: [192.168.171.12] =&gt; &#123;</span><br><span class="line">    &quot;cs.stdout_lines&quot;: [</span><br><span class="line">        &quot;NAME                 AGE&quot;,</span><br><span class="line">        &quot;scheduler            &lt;unknown&gt;&quot;,</span><br><span class="line">        &quot;controller-manager   &lt;unknown&gt;&quot;,</span><br><span class="line">        &quot;etcd-0               &lt;unknown&gt;&quot;,</span><br><span class="line">        &quot;etcd-1               &lt;unknown&gt;&quot;,</span><br><span class="line">        &quot;etcd-2               &lt;unknown&gt;&quot;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">TASK [master : 拷贝RBAC文件] **********************************************************************************************************************************************</span><br><span class="line">changed: [192.168.171.12] =&gt; (item=kubelet-bootstrap-rbac.yaml)</span><br><span class="line">changed: [192.168.171.12] =&gt; (item=apiserver-to-kubelet-rbac.yaml)</span><br><span class="line"></span><br><span class="line">TASK [master : 授权APIServer访问Kubelet与授权kubelet bootstrap] **************************************************************************************************************</span><br><span class="line">changed: [192.168.171.12]</span><br><span class="line"></span><br><span class="line">PLAY [5.部署K8S Node] ***************************************************************************************************************************************************</span><br><span class="line"></span><br><span class="line">TASK [node : 创建工作目录] **************************************************************************************************************************************************</span><br><span class="line">changed: [192.168.171.13] =&gt; (item=bin)</span><br><span class="line">changed: [192.168.171.14] =&gt; (item=bin)</span><br><span class="line">ok: [192.168.171.12] =&gt; (item=bin)</span><br><span class="line">changed: [192.168.171.13] =&gt; (item=cfg)</span><br><span class="line">changed: [192.168.171.14] =&gt; (item=cfg)</span><br><span class="line">ok: [192.168.171.12] =&gt; (item=cfg)</span><br><span class="line">changed: [192.168.171.14] =&gt; (item=ssl)</span><br><span class="line">changed: [192.168.171.13] =&gt; (item=ssl)</span><br><span class="line">ok: [192.168.171.12] =&gt; (item=ssl)</span><br><span class="line">changed: [192.168.171.14] =&gt; (item=logs)</span><br><span class="line">ok: [192.168.171.12] =&gt; (item=logs)</span><br><span class="line">changed: [192.168.171.13] =&gt; (item=logs)</span><br><span class="line"></span><br><span class="line">TASK [node : 创建cni插件目录] ***********************************************************************************************************************************************</span><br><span class="line">changed: [192.168.171.14] =&gt; (item=/opt/cni/bin)</span><br><span class="line">changed: [192.168.171.13] =&gt; (item=/opt/cni/bin)</span><br><span class="line">changed: [192.168.171.12] =&gt; (item=/opt/cni/bin)</span><br><span class="line">changed: [192.168.171.13] =&gt; (item=/etc/cni/net.d)</span><br><span class="line">changed: [192.168.171.14] =&gt; (item=/etc/cni/net.d)</span><br><span class="line">changed: [192.168.171.12] =&gt; (item=/etc/cni/net.d)</span><br><span class="line"></span><br><span class="line">TASK [node : 创建临时目录] **************************************************************************************************************************************************</span><br><span class="line">ok: [192.168.171.12]</span><br><span class="line">ok: [192.168.171.13]</span><br><span class="line">ok: [192.168.171.14]</span><br><span class="line"></span><br><span class="line">TASK [node : 分发并解压k8s二进制包] ********************************************************************************************************************************************</span><br><span class="line">ok: [192.168.171.12] =&gt; (item=/root/binary_pkg/kubernetes-server-linux-amd64-1.16.tar.gz)</span><br><span class="line">changed: [192.168.171.13] =&gt; (item=/root/binary_pkg/kubernetes-server-linux-amd64-1.16.tar.gz)</span><br><span class="line">changed: [192.168.171.14] =&gt; (item=/root/binary_pkg/kubernetes-server-linux-amd64-1.16.tar.gz)</span><br><span class="line"></span><br><span class="line">TASK [node : 分发并解压cni插件二进制包] ******************************************************************************************************************************************</span><br><span class="line">changed: [192.168.171.14] =&gt; (item=/root/binary_pkg/cni-plugins-linux-amd64-v0.8.2.tgz)</span><br><span class="line">changed: [192.168.171.12] =&gt; (item=/root/binary_pkg/cni-plugins-linux-amd64-v0.8.2.tgz)</span><br><span class="line">changed: [192.168.171.13] =&gt; (item=/root/binary_pkg/cni-plugins-linux-amd64-v0.8.2.tgz)</span><br><span class="line"></span><br><span class="line">TASK [node : 移动k8s node二进制文件] *****************************************************************************************************************************************</span><br><span class="line">changed: [192.168.171.12]</span><br><span class="line">changed: [192.168.171.13]</span><br><span class="line">changed: [192.168.171.14]</span><br><span class="line"></span><br><span class="line">TASK [node : 分发k8s证书] *************************************************************************************************************************************************</span><br><span class="line">ok: [192.168.171.12] =&gt; (item=ca.pem)</span><br><span class="line">changed: [192.168.171.13] =&gt; (item=ca.pem)</span><br><span class="line">changed: [192.168.171.14] =&gt; (item=ca.pem)</span><br><span class="line">changed: [192.168.171.12] =&gt; (item=kube-proxy.pem)</span><br><span class="line">changed: [192.168.171.14] =&gt; (item=kube-proxy.pem)</span><br><span class="line">changed: [192.168.171.13] =&gt; (item=kube-proxy.pem)</span><br><span class="line">changed: [192.168.171.12] =&gt; (item=kube-proxy-key.pem)</span><br><span class="line">changed: [192.168.171.13] =&gt; (item=kube-proxy-key.pem)</span><br><span class="line">changed: [192.168.171.14] =&gt; (item=kube-proxy-key.pem)</span><br><span class="line"></span><br><span class="line">TASK [node : 分发k8s配置文件] ***********************************************************************************************************************************************</span><br><span class="line">changed: [192.168.171.12] =&gt; (item=bootstrap.kubeconfig.j2)</span><br><span class="line">changed: [192.168.171.13] =&gt; (item=bootstrap.kubeconfig.j2)</span><br><span class="line">changed: [192.168.171.14] =&gt; (item=bootstrap.kubeconfig.j2)</span><br><span class="line">changed: [192.168.171.14] =&gt; (item=kubelet.conf.j2)</span><br><span class="line">changed: [192.168.171.13] =&gt; (item=kubelet.conf.j2)</span><br><span class="line">changed: [192.168.171.12] =&gt; (item=kubelet.conf.j2)</span><br><span class="line">changed: [192.168.171.12] =&gt; (item=kubelet-config.yml.j2)</span><br><span class="line">changed: [192.168.171.13] =&gt; (item=kubelet-config.yml.j2)</span><br><span class="line">changed: [192.168.171.14] =&gt; (item=kubelet-config.yml.j2)</span><br><span class="line">changed: [192.168.171.14] =&gt; (item=kube-proxy.kubeconfig.j2)</span><br><span class="line">changed: [192.168.171.13] =&gt; (item=kube-proxy.kubeconfig.j2)</span><br><span class="line">changed: [192.168.171.12] =&gt; (item=kube-proxy.kubeconfig.j2)</span><br><span class="line">changed: [192.168.171.14] =&gt; (item=kube-proxy.conf.j2)</span><br><span class="line">changed: [192.168.171.12] =&gt; (item=kube-proxy.conf.j2)</span><br><span class="line">changed: [192.168.171.13] =&gt; (item=kube-proxy.conf.j2)</span><br><span class="line">changed: [192.168.171.12] =&gt; (item=kube-proxy-config.yml.j2)</span><br><span class="line">changed: [192.168.171.14] =&gt; (item=kube-proxy-config.yml.j2)</span><br><span class="line">changed: [192.168.171.13] =&gt; (item=kube-proxy-config.yml.j2)</span><br><span class="line"></span><br><span class="line">TASK [node : 分发service文件] *********************************************************************************************************************************************</span><br><span class="line">changed: [192.168.171.12] =&gt; (item=kubelet.service.j2)</span><br><span class="line">changed: [192.168.171.13] =&gt; (item=kubelet.service.j2)</span><br><span class="line">changed: [192.168.171.14] =&gt; (item=kubelet.service.j2)</span><br><span class="line">changed: [192.168.171.14] =&gt; (item=kube-proxy.service.j2)</span><br><span class="line">changed: [192.168.171.12] =&gt; (item=kube-proxy.service.j2)</span><br><span class="line">changed: [192.168.171.13] =&gt; (item=kube-proxy.service.j2)</span><br><span class="line"></span><br><span class="line">TASK [node : 启动k8s node组件] ********************************************************************************************************************************************</span><br><span class="line">changed: [192.168.171.13] =&gt; (item=kubelet)</span><br><span class="line">changed: [192.168.171.14] =&gt; (item=kubelet)</span><br><span class="line">changed: [192.168.171.12] =&gt; (item=kubelet)</span><br><span class="line">changed: [192.168.171.14] =&gt; (item=kube-proxy)</span><br><span class="line">changed: [192.168.171.13] =&gt; (item=kube-proxy)</span><br><span class="line">changed: [192.168.171.12] =&gt; (item=kube-proxy)</span><br><span class="line"></span><br><span class="line">TASK [node : 分发预准备镜像] *************************************************************************************************************************************************</span><br><span class="line">changed: [192.168.171.14]</span><br><span class="line">changed: [192.168.171.13]</span><br><span class="line">changed: [192.168.171.12]</span><br><span class="line"></span><br><span class="line">TASK [node : 导入镜像] ****************************************************************************************************************************************************</span><br><span class="line">changed: [192.168.171.12]</span><br><span class="line">changed: [192.168.171.14]</span><br><span class="line">changed: [192.168.171.13]</span><br><span class="line"></span><br><span class="line">PLAY [6.部署插件] *********************************************************************************************************************************************************</span><br><span class="line"></span><br><span class="line">TASK [addons : 允许Node加入集群] ********************************************************************************************************************************************</span><br><span class="line">changed: [192.168.171.12]</span><br><span class="line"></span><br><span class="line">TASK [addons : 拷贝YAML文件到Master] ***************************************************************************************************************************************</span><br><span class="line">changed: [192.168.171.12] =&gt; (item=/root/ansible-install-k8s-master/roles/addons/files/coredns.yaml)</span><br><span class="line">changed: [192.168.171.12] =&gt; (item=/root/ansible-install-k8s-master/roles/addons/files/ingress-controller.yaml)</span><br><span class="line">changed: [192.168.171.12] =&gt; (item=/root/ansible-install-k8s-master/roles/addons/files/kube-flannel.yaml)</span><br><span class="line">changed: [192.168.171.12] =&gt; (item=/root/ansible-install-k8s-master/roles/addons/files/kubernetes-dashboard.yaml)</span><br><span class="line"></span><br><span class="line">TASK [addons : 部署Flannel,Dashboard,CoreDNS,Ingress] *******************************************************************************************************************</span><br><span class="line">changed: [192.168.171.12]</span><br><span class="line"></span><br><span class="line">TASK [addons : 替换Dashboard证书] *****************************************************************************************************************************************</span><br><span class="line">changed: [192.168.171.12]</span><br><span class="line"></span><br><span class="line">TASK [addons : 查看Pod状态] ***********************************************************************************************************************************************</span><br><span class="line">changed: [192.168.171.12]</span><br><span class="line"></span><br><span class="line">TASK [addons : debug] *************************************************************************************************************************************************</span><br><span class="line">ok: [192.168.171.12] =&gt; &#123;</span><br><span class="line">    &quot;getall.stdout_lines&quot;: [</span><br><span class="line">        &quot;NAMESPACE              NAME                                             READY   STATUS    RESTARTS   AGE&quot;,</span><br><span class="line">        &quot;kube-system            pod/coredns-6d8cfdd59d-hcfw5                     0/1     Pending   0          2s&quot;,</span><br><span class="line">        &quot;kubernetes-dashboard   pod/dashboard-metrics-scraper-566cddb686-nk7t8   0/1     Pending   0          1s&quot;,</span><br><span class="line">        &quot;kubernetes-dashboard   pod/kubernetes-dashboard-c4bc5bd44-cxgb6         0/1     Pending   0          1s&quot;,</span><br><span class="line">        &quot;&quot;,</span><br><span class="line">        &quot;NAMESPACE              NAME                                TYPE        CLUSTER-IP   EXTERNAL-IP   PORT(S)          AGE&quot;,</span><br><span class="line">        &quot;default                service/kubernetes                  ClusterIP   10.0.0.1     &lt;none&gt;        443/TCP          2m19s&quot;,</span><br><span class="line">        &quot;ingress-nginx          service/ingress-nginx               ClusterIP   10.0.0.158   &lt;none&gt;        80/TCP,443/TCP   2s&quot;,</span><br><span class="line">        &quot;kube-system            service/kube-dns                    ClusterIP   10.0.0.2     &lt;none&gt;        53/UDP,53/TCP    2s&quot;,</span><br><span class="line">        &quot;kubernetes-dashboard   service/dashboard-metrics-scraper   ClusterIP   10.0.0.38    &lt;none&gt;        8000/TCP         1s&quot;,</span><br><span class="line">        &quot;kubernetes-dashboard   service/kubernetes-dashboard        NodePort    10.0.0.180   &lt;none&gt;        443:30001/TCP    1s&quot;,</span><br><span class="line">        &quot;&quot;,</span><br><span class="line">        &quot;NAMESPACE       NAME                                      DESIRED   CURRENT   READY   UP-TO-DATE   AVAILABLE   NODE SELECTOR   AGE&quot;,</span><br><span class="line">        &quot;ingress-nginx   daemonset.apps/nginx-ingress-controller   0         0         0       0            0           &lt;none&gt;          2s&quot;,</span><br><span class="line">        &quot;kube-system     daemonset.apps/kube-flannel-ds-amd64      0         0         0       0            0           &lt;none&gt;          2s&quot;,</span><br><span class="line">        &quot;&quot;,</span><br><span class="line">        &quot;NAMESPACE              NAME                                        READY   UP-TO-DATE   AVAILABLE   AGE&quot;,</span><br><span class="line">        &quot;kube-system            deployment.apps/coredns                     0/1     1            0           2s&quot;,</span><br><span class="line">        &quot;kubernetes-dashboard   deployment.apps/dashboard-metrics-scraper   0/1     1            0           1s&quot;,</span><br><span class="line">        &quot;kubernetes-dashboard   deployment.apps/kubernetes-dashboard        0/1     1            0           1s&quot;,</span><br><span class="line">        &quot;&quot;,</span><br><span class="line">        &quot;NAMESPACE              NAME                                                   DESIRED   CURRENT   READY   AGE&quot;,</span><br><span class="line">        &quot;kube-system            replicaset.apps/coredns-6d8cfdd59d                     1         1         0       2s&quot;,</span><br><span class="line">        &quot;kubernetes-dashboard   replicaset.apps/dashboard-metrics-scraper-566cddb686   1         1         0       1s&quot;,</span><br><span class="line">        &quot;kubernetes-dashboard   replicaset.apps/kubernetes-dashboard-c4bc5bd44         1         1         0       1s&quot;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">TASK [addons : 创建Dashboard管理员令牌] **************************************************************************************************************************************</span><br><span class="line">changed: [192.168.171.12]</span><br><span class="line"></span><br><span class="line">TASK [addons : 获取Dashboard管理员令牌] **************************************************************************************************************************************</span><br><span class="line">changed: [192.168.171.12]</span><br><span class="line"></span><br><span class="line">TASK [addons : Kubernetes Dashboard登录信息] ******************************************************************************************************************************</span><br><span class="line">ok: [192.168.171.12] =&gt; &#123;</span><br><span class="line">    &quot;ui.stdout_lines&quot;: [</span><br><span class="line">        &quot;访问地址---&gt;https://NodeIP:30001&quot;,</span><br><span class="line">        &quot;令牌内容---&gt;eyJhbGciOiJSUzI1NiIsImtpZCI6IlhOV0FZU1ZXRU80MU5oRUlYeGsxbExFcVB1R1k0bEEzMDhQQWdWVE5oZG8ifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlcm5ldGVzLWRhc2hib2FyZCIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJkYXNoYm9hcmQtYWRtaW4tdG9rZW4tenQ2Y3ciLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC5uYW1lIjoiZGFzaGJvYXJkLWFkbWluIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQudWlkIjoiMTU3YjEyYmYtNjNjNC00NzU1LWI4YTAtN2IyY2ZkZmRmNmE3Iiwic3ViIjoic3lzdGVtOnNlcnZpY2VhY2NvdW50Omt1YmVybmV0ZXMtZGFzaGJvYXJkOmRhc2hib2FyZC1hZG1pbiJ9.fKCHvmsmZmIErB9YLHtQrqWQBL_b89W0i_gDa4rwgV9x4UfzVAXskUiZiQs_yAHNmyUaIqPpBdUI64pvAoXilr-6wIk8-R8hpp4BJXLL4OsTtPXxrhIQF4_NP0D-4flg9sHba-I9X9A_2RWskcY53PAPTOjlyOQuldUyTdIT9tXi6jeSgj8CrDBc9O_A3xYWZ1f7RvrdEdU4Kkotc1rsBeGg-OzabU1nNLxWAaDHZJFciYeABtbPoY2fTkdz0JGoIxLpAqcQKoFp9ztGPcoOboCOqeb_hc-caBAmyvVIfbPvBiywdtuidjvb1IazETt_GQlzg7FMBoUpHhJYOTvnAA&quot;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">PLAY RECAP ************************************************************************************************************************************************************</span><br><span class="line">192.168.171.12             : ok=61   changed=40   unreachable=0    failed=0</span><br><span class="line">192.168.171.13             : ok=38   changed=23   unreachable=0    failed=0</span><br><span class="line">192.168.171.14             : ok=38   changed=23   unreachable=0    failed=0</span><br><span class="line">localhost                  : ok=9    changed=3    unreachable=0    failed=0</span><br></pre></td></tr></table></figure>
<h4 id="2-3、测试"><a href="#2-3、测试" class="headerlink" title="2.3、测试"></a>2.3、测试</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[root@k8s-ansible2 ~]# kubectl get nodes</span><br><span class="line">NAME           STATUS   ROLES    AGE    VERSION</span><br><span class="line">k8s-ansible2   Ready    &lt;none&gt;   117s   v1.16.0</span><br><span class="line">k8s-ansible3   Ready    &lt;none&gt;   117s   v1.16.0</span><br><span class="line">k8s-ansible4   Ready    &lt;none&gt;   117s   v1.16.0</span><br><span class="line"></span><br><span class="line">[root@k8s-ansible2 ~]# kubectl get po --all-namespaces -o wide</span><br><span class="line">NAMESPACE              NAME                                         READY   STATUS    RESTARTS   AGE     IP               NODE           NOMINATED NODE   READINESS GATES</span><br><span class="line">ingress-nginx          nginx-ingress-controller-7g9fh               1/1     Running   0          2m41s   192.168.171.13   k8s-ansible3   &lt;none&gt;           &lt;none&gt;</span><br><span class="line">ingress-nginx          nginx-ingress-controller-hc492               1/1     Running   0          2m41s   192.168.171.14   k8s-ansible4   &lt;none&gt;           &lt;none&gt;</span><br><span class="line">ingress-nginx          nginx-ingress-controller-s4slm               1/1     Running   0          2m41s   192.168.171.12   k8s-ansible2   &lt;none&gt;           &lt;none&gt;</span><br><span class="line">kube-system            coredns-6d8cfdd59d-hcfw5                     1/1     Running   0          3m8s    10.244.1.2       k8s-ansible2   &lt;none&gt;           &lt;none&gt;</span><br><span class="line">kube-system            kube-flannel-ds-amd64-6nbt4                  1/1     Running   0          2m51s   192.168.171.12   k8s-ansible2   &lt;none&gt;           &lt;none&gt;</span><br><span class="line">kube-system            kube-flannel-ds-amd64-mfksz                  1/1     Running   0          2m51s   192.168.171.14   k8s-ansible4   &lt;none&gt;           &lt;none&gt;</span><br><span class="line">kube-system            kube-flannel-ds-amd64-vclgg                  1/1     Running   0          2m51s   192.168.171.13   k8s-ansible3   &lt;none&gt;           &lt;none&gt;</span><br><span class="line">kubernetes-dashboard   dashboard-metrics-scraper-566cddb686-nk7t8   1/1     Running   0          3m7s    10.244.2.2       k8s-ansible4   &lt;none&gt;           &lt;none&gt;</span><br><span class="line">kubernetes-dashboard   kubernetes-dashboard-c4bc5bd44-cxgb6         1/1     Running   0          3m7s    10.244.0.2       k8s-ansible3   &lt;none&gt;           &lt;none&gt;</span><br><span class="line"></span><br><span class="line">[root@k8s-ansible2 ~]# kubectl get csr</span><br><span class="line">NAME                                                   AGE    REQUESTOR           CONDITION</span><br><span class="line">node-csr-96KwqYYgTQ0ajISzq2pUc5Dzu07UzjaKRZqRWs31yUk   5m5s   kubelet-bootstrap   Approved,Issued</span><br><span class="line">node-csr-9PduNyHHpXtDmuNFj3fCkpoNkGcDkO2NPEk3uGQ3kIk   5m6s   kubelet-bootstrap   Approved,Issued</span><br><span class="line">node-csr-WLFKgflHlDK2f0RFvuTYKlkHcr8hz0iOrzYcp2V50JE   5m6s   kubelet-bootstrap   Approved,Issued</span><br></pre></td></tr></table></figure>
<p><img src="http://myimage.okay686.cn/okay686cn/20191204/RlnwtcB5dboO.png?imageslim" alt="mark"></p>
<hr>
<h3 id="三、多master部署"><a href="#三、多master部署" class="headerlink" title="三、多master部署"></a>三、多master部署</h3><h4 id="3-1、hosts"><a href="#3-1、hosts" class="headerlink" title="3.1、hosts"></a>3.1、hosts</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">[root@k8s-ansible1 ansible-install-k8s-master]# cat hosts</span><br><span class="line">[master]</span><br><span class="line"># 如果部署单Master，只保留一个Master节点</span><br><span class="line">192.168.171.11 node_name=k8s-master1</span><br><span class="line">192.168.171.12 node_name=k8s-master2</span><br><span class="line"></span><br><span class="line">[node]</span><br><span class="line">192.168.171.13 node_name=k8s-node1</span><br><span class="line">192.168.171.14 node_name=k8s-node2</span><br><span class="line"></span><br><span class="line">[etcd]</span><br><span class="line">192.168.171.11 etcd_name=etcd-1</span><br><span class="line">192.168.171.12 etcd_name=etcd-2</span><br><span class="line">192.168.171.13 etcd_name=etcd-3</span><br><span class="line"></span><br><span class="line">[lb]</span><br><span class="line"># 如果部署单Master，该项忽略</span><br><span class="line">192.168.171.15 lb_name=lb-master</span><br><span class="line">192.168.171.16 lb_name=lb-backup</span><br><span class="line"></span><br><span class="line">[k8s:children]</span><br><span class="line">master</span><br><span class="line">node</span><br><span class="line"></span><br><span class="line">[newnode]</span><br><span class="line">#192.168.31.91 node_name=k8s-node3</span><br></pre></td></tr></table></figure>
<h4 id="3-2、全局参数配置"><a href="#3-2、全局参数配置" class="headerlink" title="3.2、全局参数配置"></a>3.2、全局参数配置</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">[root@k8s-ansible1 ansible-install-k8s-master]# cat group_vars/all.yml</span><br><span class="line"># 安装目录</span><br><span class="line">software_dir: &apos;/root/binary_pkg&apos;</span><br><span class="line">k8s_work_dir: &apos;/opt/kubernetes&apos;</span><br><span class="line">etcd_work_dir: &apos;/opt/etcd&apos;</span><br><span class="line">tmp_dir: &apos;/tmp/k8s&apos;</span><br><span class="line"></span><br><span class="line"># 集群网络</span><br><span class="line">service_cidr: &apos;10.0.0.0/24&apos;</span><br><span class="line">cluster_dns: &apos;10.0.0.2&apos;   # 与roles/addons/files/coredns.yaml中IP一致</span><br><span class="line">pod_cidr: &apos;10.244.0.0/16&apos; # 与roles/addons/files/kube-flannel.yaml中网段一致</span><br><span class="line">service_nodeport_range: &apos;30000-32767&apos;</span><br><span class="line">cluster_domain: &apos;cluster.local&apos;</span><br><span class="line"></span><br><span class="line"># 高可用，如果部署单Master，该项忽略</span><br><span class="line">vip: &apos;192.168.171.88&apos;</span><br><span class="line">nic: &apos;ens33&apos;</span><br><span class="line"></span><br><span class="line"># 自签证书可信任IP列表，为方便扩展，可添加多个预留IP</span><br><span class="line">cert_hosts:</span><br><span class="line">  # 包含所有LB、VIP、Master IP和service_cidr的第一个IP（多多益善，可以多余出来几个后期扩展用）</span><br><span class="line">  k8s:</span><br><span class="line">    - 10.0.0.1</span><br><span class="line">    - 192.168.171.11</span><br><span class="line">    - 192.168.171.12</span><br><span class="line">    - 192.168.171.13</span><br><span class="line">    - 192.168.171.14</span><br><span class="line">    - 192.168.171.15</span><br><span class="line">    - 192.168.171.16</span><br><span class="line">    - 192.168.171.17</span><br><span class="line">    - 192.168.171.18</span><br><span class="line">    - 192.168.171.19</span><br><span class="line">    - 192.168.171.10</span><br><span class="line">    - 192.168.171.21</span><br><span class="line">    - 192.168.171.88</span><br><span class="line">  # 包含所有etcd节点IP</span><br><span class="line">  etcd:</span><br><span class="line">    - 192.168.171.11</span><br><span class="line">    - 192.168.171.12</span><br><span class="line">    - 192.168.171.13</span><br></pre></td></tr></table></figure>
<h4 id="3-3、准备部署"><a href="#3-3、准备部署" class="headerlink" title="3.3、准备部署"></a>3.3、准备部署</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">多Master版：</span><br><span class="line"></span><br><span class="line">ansible-playbook -i hosts multi-master-deploy.yml -uroot -k</span><br></pre></td></tr></table></figure>
<h4 id="3-4、输出历史（重点是结果）"><a href="#3-4、输出历史（重点是结果）" class="headerlink" title="3.4、输出历史（重点是结果）"></a>3.4、输出历史（重点是结果）</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">省略...</span><br></pre></td></tr></table></figure>
<h4 id="3-5、测试"><a href="#3-5、测试" class="headerlink" title="3.5、测试"></a>3.5、测试</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">[root@k8s-ansible1 ~]# kubectl get node</span><br><span class="line">NAME          STATUS   ROLES    AGE   VERSION</span><br><span class="line">k8s-master1   Ready    &lt;none&gt;   85s   v1.16.0</span><br><span class="line">k8s-master2   Ready    &lt;none&gt;   85s   v1.16.0</span><br><span class="line">k8s-node1     Ready    &lt;none&gt;   85s   v1.16.0</span><br><span class="line">k8s-node2     Ready    &lt;none&gt;   85s   v1.16.0</span><br><span class="line"></span><br><span class="line">[root@k8s-ansible1 ~]# kubectl get po,svc --all-namespaces</span><br><span class="line">NAMESPACE              NAME                                             READY   STATUS    RESTARTS   AGE</span><br><span class="line">ingress-nginx          pod/nginx-ingress-controller-92b8v               1/1     Running   0          90s</span><br><span class="line">ingress-nginx          pod/nginx-ingress-controller-dfkp5               1/1     Running   0          90s</span><br><span class="line">ingress-nginx          pod/nginx-ingress-controller-hckvr               1/1     Running   0          91s</span><br><span class="line">ingress-nginx          pod/nginx-ingress-controller-qckdd               1/1     Running   0          90s</span><br><span class="line">kube-system            pod/coredns-6d8cfdd59d-lsdps                     1/1     Running   0          117s</span><br><span class="line">kube-system            pod/kube-flannel-ds-amd64-2mc74                  1/1     Running   1          100s</span><br><span class="line">kube-system            pod/kube-flannel-ds-amd64-4hqq7                  1/1     Running   0          101s</span><br><span class="line">kube-system            pod/kube-flannel-ds-amd64-dgzrb                  1/1     Running   0          100s</span><br><span class="line">kube-system            pod/kube-flannel-ds-amd64-zjtpq                  1/1     Running   0          100s</span><br><span class="line">kubernetes-dashboard   pod/dashboard-metrics-scraper-566cddb686-9xh7b   1/1     Running   0          116s</span><br><span class="line">kubernetes-dashboard   pod/kubernetes-dashboard-c4bc5bd44-4f45q         1/1     Running   0          116s</span><br><span class="line"></span><br><span class="line">NAMESPACE              NAME                                TYPE        CLUSTER-IP   EXTERNAL-IP   PORT(S)          AGE</span><br><span class="line">default                service/kubernetes                  ClusterIP   10.0.0.1     &lt;none&gt;        443/TCP          5m40s</span><br><span class="line">ingress-nginx          service/ingress-nginx               ClusterIP   10.0.0.170   &lt;none&gt;        80/TCP,443/TCP   117s</span><br><span class="line">kube-system            service/kube-dns                    ClusterIP   10.0.0.2     &lt;none&gt;        53/UDP,53/TCP    117s</span><br><span class="line">kubernetes-dashboard   service/dashboard-metrics-scraper   ClusterIP   10.0.0.172   &lt;none&gt;        8000/TCP         116s</span><br><span class="line">kubernetes-dashboard   service/kubernetes-dashboard        NodePort    10.0.0.57    &lt;none&gt;        443:30001/TCP    116s</span><br><span class="line">[root@k8s-ansible1 ~]# kubectl get po,svc --all-namespaces -o wide</span><br><span class="line">NAMESPACE              NAME                                             READY   STATUS    RESTARTS   AGE    IP               NODE          NOMINATED NODE   READINESS GATES</span><br><span class="line">ingress-nginx          pod/nginx-ingress-controller-92b8v               1/1     Running   0          96s    192.168.171.11   k8s-master1   &lt;none&gt;           &lt;none&gt;</span><br><span class="line">ingress-nginx          pod/nginx-ingress-controller-dfkp5               1/1     Running   0          96s    192.168.171.12   k8s-master2   &lt;none&gt;           &lt;none&gt;</span><br><span class="line">ingress-nginx          pod/nginx-ingress-controller-hckvr               1/1     Running   0          97s    192.168.171.13   k8s-node1     &lt;none&gt;           &lt;none&gt;</span><br><span class="line">ingress-nginx          pod/nginx-ingress-controller-qckdd               1/1     Running   0          96s    192.168.171.14   k8s-node2     &lt;none&gt;           &lt;none&gt;</span><br><span class="line">kube-system            pod/coredns-6d8cfdd59d-lsdps                     1/1     Running   0          2m3s   10.244.1.2       k8s-master2   &lt;none&gt;           &lt;none&gt;</span><br><span class="line">kube-system            pod/kube-flannel-ds-amd64-2mc74                  1/1     Running   1          106s   192.168.171.12   k8s-master2   &lt;none&gt;           &lt;none&gt;</span><br><span class="line">kube-system            pod/kube-flannel-ds-amd64-4hqq7                  1/1     Running   0          107s   192.168.171.13   k8s-node1     &lt;none&gt;           &lt;none&gt;</span><br><span class="line">kube-system            pod/kube-flannel-ds-amd64-dgzrb                  1/1     Running   0          106s   192.168.171.14   k8s-node2     &lt;none&gt;           &lt;none&gt;</span><br><span class="line">kube-system            pod/kube-flannel-ds-amd64-zjtpq                  1/1     Running   0          106s   192.168.171.11   k8s-master1   &lt;none&gt;           &lt;none&gt;</span><br><span class="line">kubernetes-dashboard   pod/dashboard-metrics-scraper-566cddb686-9xh7b   1/1     Running   0          2m2s   10.244.2.2       k8s-master1   &lt;none&gt;           &lt;none&gt;</span><br><span class="line">kubernetes-dashboard   pod/kubernetes-dashboard-c4bc5bd44-4f45q         1/1     Running   0          2m2s   10.244.3.2       k8s-node2     &lt;none&gt;           &lt;none&gt;</span><br><span class="line"></span><br><span class="line">NAMESPACE              NAME                                TYPE        CLUSTER-IP   EXTERNAL-IP   PORT(S)          AGE     SELECTOR</span><br><span class="line">default                service/kubernetes                  ClusterIP   10.0.0.1     &lt;none&gt;        443/TCP          5m46s   &lt;none&gt;</span><br><span class="line">ingress-nginx          service/ingress-nginx               ClusterIP   10.0.0.170   &lt;none&gt;        80/TCP,443/TCP   2m3s    app.kubernetes.io/name=ingress-nginx,app.kubernetes.io/part-of=ingress-nginx</span><br><span class="line">kube-system            service/kube-dns                    ClusterIP   10.0.0.2     &lt;none&gt;        53/UDP,53/TCP    2m3s    k8s-app=kube-dns</span><br><span class="line">kubernetes-dashboard   service/dashboard-metrics-scraper   ClusterIP   10.0.0.172   &lt;none&gt;        8000/TCP         2m2s    k8s-app=dashboard-metrics-scraper</span><br><span class="line">kubernetes-dashboard   service/kubernetes-dashboard        NodePort    10.0.0.57    &lt;none&gt;        443:30001/TCP    2m2s    k8s-app=kubernetes-dashboard</span><br><span class="line"></span><br><span class="line">### 检查高可用的两台机器：</span><br><span class="line"></span><br><span class="line">[root@k8s-ansible5 ~]# ip a</span><br><span class="line">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000</span><br><span class="line">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br><span class="line">    inet 127.0.0.1/8 scope host lo</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 ::1/128 scope host</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">2: ens33: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP group default qlen 1000</span><br><span class="line">    link/ether 00:0c:29:85:37:e0 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 192.168.171.15/24 brd 192.168.171.255 scope global noprefixroute ens33</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet 192.168.171.88/24 scope global secondary ens33     ##虚拟VIP</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 fe80::d20b:b903:7edd:b18b/64 scope link tentative noprefixroute dadfailed</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 fe80::5d9e:cf1f:ea7f:801f/64 scope link tentative noprefixroute dadfailed</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 fe80::5c0:8885:2874:a77b/64 scope link tentative noprefixroute dadfailed</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">[root@k8s-ansible5 ~]# ps aux | grep nginx</span><br><span class="line">root       7895  0.0  0.0  46356  1168 ?        Ss   22:57   0:00 nginx: master process /usr/sbin/nginx -c /etc/nginx/nginx.conf</span><br><span class="line">nginx      7896  0.1  0.1  47184  2308 ?        S    22:57   0:00 nginx: worker process</span><br><span class="line">nginx      7897  0.0  0.1  46780  1980 ?        S    22:57   0:00 nginx: worker process</span><br><span class="line">nginx      7898  0.0  0.1  46924  2216 ?        S    22:57   0:00 nginx: worker process</span><br><span class="line">nginx      7899  0.0  0.1  46876  2220 ?        S    22:57   0:00 nginx: worker process</span><br><span class="line">root      11331  0.0  0.0 112728   988 pts/0    S+   23:07   0:00 grep --color=auto nginx</span><br><span class="line">[root@k8s-ansible5 ~]# ps aux | grep keepalived</span><br><span class="line">root       7975  0.0  0.0 122884  1404 ?        Ss   22:57   0:00 /usr/sbin/keepalived -D</span><br><span class="line">root       7976  0.0  0.1 133844  3336 ?        S    22:57   0:00 /usr/sbin/keepalived -D</span><br><span class="line">root       7977  0.0  0.1 133784  2892 ?        S    22:57   0:00 /usr/sbin/keepalived -D</span><br><span class="line">root      11369  0.0  0.0 112724   992 pts/0    R+   23:07   0:00 grep --color=auto keepalived</span><br></pre></td></tr></table></figure>
<p><img src="http://myimage.okay686.cn/okay686cn/20191204/7GzoI4FprwXv.png?imageslim" alt="mark"></p>
<hr>

            <div class="post-copyright">
    <div class="content">
        <p>最后更新： 2019年12月05日 17:13</p>
        <p>原始链接： <a class="post-url" href="/2019/12/05/ansible自动化部署kubernetes-1.16/" title="ansible自动化部署kubernetes-1.16">http://zhdya.okay686.cn/2019/12/05/ansible自动化部署kubernetes-1.16/</a></p>
        <footer>
            <a href="http://zhdya.okay686.cn">
                <img src="/images/logo.png" alt="Zhdya">
                Zhdya
            </a>
        </footer>
    </div>
</div>

      
        
            
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;">赏</a>
</div>

<div id="reward" class="post-modal reward-lay">
    <a class="close" href="javascript:;" id="reward-close">×</a>
    <span class="reward-title">
        <i class="icon icon-quote-left"></i>
        老板，中午饭可否加餐？
        <i class="icon icon-quote-right"></i>
    </span>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/images/wechat_code.jpg" alt="打赏二维码">
        </div>
        <div class="reward-select">
            
            <label class="reward-select-item checked" data-id="wechat" data-wechat="/images/wechat_code.jpg">
                <img class="reward-select-item-wechat" src="/images/wechat.png" alt="微信">
            </label>
            
            
            <label class="reward-select-item" data-id="alipay" data-alipay="/images/alipay_code.jpg">
                <img class="reward-select-item-alipay" src="/images/alipay.png" alt="支付宝">
            </label>
            
        </div>
    </div>
</div>


        
    </div>
    <footer class="article-footer">
        
        
<div class="post-share">
    <a href="javascript:;" id="share-sub" class="post-share-fab">
        <i class="fa fa-share-alt"></i>
    </a>
    <div class="post-share-list" id="share-list">
        <ul class="share-icons">
          <li>
            <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://zhdya.okay686.cn/2019/12/05/ansible自动化部署kubernetes-1.16/&title=《ansible自动化部署kubernetes-1.16》 — 成年人的世界哪有容易二字！&pic=/images/k8s.jpg" data-title="微博">
              <i class="fa fa-weibo"></i>
            </a>
          </li>
          <li>
            <a class="weixin share-sns" id="wxFab" href="javascript:;" data-title="微信">
              <i class="fa fa-weixin"></i>
            </a>
          </li>
          <li>
            <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://zhdya.okay686.cn/2019/12/05/ansible自动化部署kubernetes-1.16/&title=《ansible自动化部署kubernetes-1.16》 — 成年人的世界哪有容易二字！&source=Tough times never last, but tough people do." data-title="QQ">
              <i class="fa fa-qq"></i>
            </a>
          </li>
          <li>
            <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://zhdya.okay686.cn/2019/12/05/ansible自动化部署kubernetes-1.16/" data-title="Facebook">
              <i class="fa fa-facebook"></i>
            </a>
          </li>
          <li>
            <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《ansible自动化部署kubernetes-1.16》 — 成年人的世界哪有容易二字！&url=http://zhdya.okay686.cn/2019/12/05/ansible自动化部署kubernetes-1.16/&via=http://zhdya.okay686.cn" data-title="Twitter">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
          <li>
            <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://zhdya.okay686.cn/2019/12/05/ansible自动化部署kubernetes-1.16/" data-title="Google+">
              <i class="fa fa-google-plus"></i>
            </a>
          </li>
        </ul>
     </div>
</div>
<div class="post-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;" id="wxShare-close">×</a>
    <p>扫一扫，分享到微信</p>
    <img src="//api.qrserver.com/v1/create-qr-code/?data=http://zhdya.okay686.cn/2019/12/05/ansible自动化部署kubernetes-1.16/" alt="微信分享二维码">
</div>

<div class="mask"></div>

        
        <ul class="article-footer-menu">
            
            
  <li class="article-footer-tags">
    <i class="fa fa-tags"></i>
      
    <a href="/tags/Kubernets/" class="color5">Kubernets</a>
      
    <a href="/tags/K8S/" class="color4">K8S</a>
      
  </li>

        </ul>
        
    </footer>
  </div>
</article>


    <aside class="post-toc-pos post-toc-top" id="post-toc">
        <nav class="post-toc-wrap">
            <ol class="post-toc"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#概述："><span class="post-toc-text">概述：</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#一、单master部署"><span class="post-toc-text">一、单master部署</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#1-1、解压缩binary-pkg-tar-gz"><span class="post-toc-text">1.1、解压缩binary_pkg.tar.gz</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#1-2、修改所以节点hosts-及ansible内的hosts"><span class="post-toc-text">1.2、修改所以节点hosts 及ansible内的hosts</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#1-3、更改全局环境配置"><span class="post-toc-text">1.3、更改全局环境配置</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#二、准备部署"><span class="post-toc-text">二、准备部署</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#2-1、单Master版："><span class="post-toc-text">2.1、单Master版：</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#2-2、历史记录"><span class="post-toc-text">2.2、历史记录</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#2-3、测试"><span class="post-toc-text">2.3、测试</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#三、多master部署"><span class="post-toc-text">三、多master部署</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#3-1、hosts"><span class="post-toc-text">3.1、hosts</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#3-2、全局参数配置"><span class="post-toc-text">3.2、全局参数配置</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#3-3、准备部署"><span class="post-toc-text">3.3、准备部署</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#3-4、输出历史（重点是结果）"><span class="post-toc-text">3.4、输出历史（重点是结果）</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#3-5、测试"><span class="post-toc-text">3.5、测试</span></a></li></ol></li></ol>
        </nav>
    </aside>
    

<nav id="article-nav">
  
    <a href="/2019/12/06/K8S集群优化之路由转发：使用IPVS替代iptables/" id="article-nav-newer" class="article-nav-link-wrap">

      <span class="article-nav-title">
        <i class="fa fa-hand-o-left" aria-hidden="true"></i>
        
          K8S集群优化之路由转发：使用IPVS替代iptables
        
      </span>
    </a>
  
  
    <a href="/2019/12/01/搭建一个生产级K8S高可用集群（2）/" id="article-nav-older" class="article-nav-link-wrap">
      <span class="article-nav-title">搭建一个生产级K8S高可用集群（2）</span>
      <i class="fa fa-hand-o-right" aria-hidden="true"></i>
    </a>
  
</nav>



    
        <section id="comments">
            <div id="disqus_thread">
                <script type="text/javascript">
                    var disqus_shortname = 'true';
                    (function() {
                        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                    })();
                </script>
                <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
            </div>
        </section>
    
</section>
        
      </div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info" class="inner">
      
<p>
    <span id="busuanzi_container_site_uv" style="display:none">
        总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style="display:none">
        总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


      <p>
        Powered by  <a href="http://hexo.io/" target="_blank">Hexo</a>
        Theme <a href="//github.com/wongminho/hexo-theme-miho" target="_blank">MiHo</a>
      &copy; 2019 Zhdya<br>
      </p>
    </div>
  </div>
</footer>
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<script src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
<script>
  var mihoConfig = {
      root: "http://zhdya.okay686.cn",
      animate: true,
      isHome: false,
      share: true,
      reward: 1
  }
</script>
<div class="sidebar">
    <div id="sidebar-search" title="Search">
        <i class="fa fa-search"></i>
    </div>
    <div id="sidebar-category" title="Categories">
        <i class="fa fa-book"></i>
    </div>
    <div id="sidebar-tag" title="Tags">
        <i class="fa fa-tags"></i>
    </div>
    <div id="sidebar-top">
        <span class="sidebar-top-icon"><i class="fa fa-angle-up"></i></span>
    </div>
</div>
<div class="sidebar-menu-box" id="sidebar-menu-box">
    <div class="sidebar-menu-box-container">
        <div id="sidebar-menu-box-categories">
            <a class="category-link" href="/categories/Django2/">Django2</a><a class="category-link" href="/categories/K8S/">K8S</a><a class="category-link" href="/categories/K8s/">K8s</a><a class="category-link" href="/categories/Python3/">Python3</a>
        </div>
        <div id="sidebar-menu-box-tags">
            <a href="/tags/BeautifulSoup/" style="font-size: 12px;">BeautifulSoup</a> <a href="/tags/CMDB/" style="font-size: 16px;">CMDB</a> <a href="/tags/K8S/" style="font-size: 14px;">K8S</a> <a href="/tags/Kubernets/" style="font-size: 14px;">Kubernets</a> <a href="/tags/calico/" style="font-size: 10px;">calico</a> <a href="/tags/django/" style="font-size: 18px;">django</a> <a href="/tags/django2-0/" style="font-size: 14px;">django2.0</a> <a href="/tags/django-blog/" style="font-size: 14px;">django_blog</a> <a href="/tags/k8s/" style="font-size: 10px;">k8s</a> <a href="/tags/python/" style="font-size: 20px;">python</a> <a href="/tags/python3/" style="font-size: 12px;">python3</a> <a href="/tags/爬虫/" style="font-size: 10px;">爬虫</a>
        </div>
    </div>
    <a href="javascript:;" class="sidebar-menu-box-close">&times;</a>
</div>
<div class="mobile-header-menu-nav" id="mobile-header-menu-nav">
    <div class="mobile-header-menu-container">
        <span class="title">Menus</span>
        <ul class="mobile-header-menu-navbar">
            
            <li>
                <a href="/">
                    <i class="fa fa-home"></i><span>主页</span>
                </a>
            </li>
            
            <li>
                <a href="/archives">
                    <i class="fa fa-archive"></i><span>归档</span>
                </a>
            </li>
            
            <li>
                <a href="/about">
                    <i class="fa fa-user"></i><span>关于</span>
                </a>
            </li>
            
        </ul>
    </div>
    <div class="mobile-header-tag-container">
        <span class="title">Tags</span>
        <div id="mobile-header-container-tags">
            <a href="/tags/BeautifulSoup/" style="font-size: 12px;">BeautifulSoup</a> <a href="/tags/CMDB/" style="font-size: 16px;">CMDB</a> <a href="/tags/K8S/" style="font-size: 14px;">K8S</a> <a href="/tags/Kubernets/" style="font-size: 14px;">Kubernets</a> <a href="/tags/calico/" style="font-size: 10px;">calico</a> <a href="/tags/django/" style="font-size: 18px;">django</a> <a href="/tags/django2-0/" style="font-size: 14px;">django2.0</a> <a href="/tags/django-blog/" style="font-size: 14px;">django_blog</a> <a href="/tags/k8s/" style="font-size: 10px;">k8s</a> <a href="/tags/python/" style="font-size: 20px;">python</a> <a href="/tags/python3/" style="font-size: 12px;">python3</a> <a href="/tags/爬虫/" style="font-size: 10px;">爬虫</a>
        </div>
    </div>
</div>
<div class="search-wrap">
    <span class="search-close">&times;</span>
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
            <i class="icon icon-lg icon-chevron-left"></i>
        </a>
        <input class="search-field" placeholder="Search..." id="keywords">
        <a id="search-submit" href="javascript:;">
            <i class="fa fa-search"></i>
        </a>
    <div class="search-container" id="search-container">
        <ul class="search-result" id="search-result">
        </ul>
    </div>
</div>

<div id="search-tpl">
    <li class="search-result-item">
        <a href="{url}" class="search-item-li">
            <span class="search-item-li-title" title="{title}">{title}</span>
        </a>
    </li>
</div>
<script src="/js/search.js"></script>
<script src="/js/main.js"></script>


  <script src="//cdn.bootcss.com/particles.js/2.0.0/particles.min.js"></script>
  <div id="particles"></div>
  <script src="/js/particles.js"></script>







  <link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css">
  <script src="//cdn.bootcss.com/scrollReveal.js/3.0.5/scrollreveal.js"></script>
  <script src="/js/animate.js"></script>


  <script src="/js/pop-img.js"></script>
  <script>
     $(".article-entry p img").popImg();
  </script>

  </div>
</body>
</html>